# Лабораторная работы #3: TODO list server-side

## Цель работы

Научиться разрабатывать клиент-серверные приложения.

## Описание

Данная лабораторная работа является продолжением лабораторной работы #2. Она будет дополнена тем, что информация о состоянии списка дел будет хранится в постоянном хранилище на сервере.

Серверный код можно написать на любом языке/фреймворке, если собственных пожеланий нет, то воспользуйтесь NodeJS примером в репозитории лабораторной работы.

С помощью HTTP сообщений мы будем запрашивать у сервера выполнить какую-то работу (получить список текущих задач, записать новую задачу в хранилище). Описние http сообщений подробнее можно прочитать тут: https://developer.mozilla.org/ru/docs/Web/HTTP/Messages

Для выполнения желательно использовать так называемую философию REST, кратко о которой вы можете прочитать в данной статье: https://habr.com/ru/post/50147/ (это больше как рекомендация к тому, как нужно писать http-запросы)

## Порядок начала работы

1. Необходимо склонировать данный репозиторий с помощью команды ```git clone https://github.com/EgorZotov/student-todo-list-server```
2. Требуется наличие NodeJS на компьютере. Установить его можно, скачав с https://nodejs.org/en/
3. Далее необходимо открыть терминал на вашем компьютере. Если вдруг кто-то это не умеет это делать: http://softwarius.ru/8-sposobov-otkryit-cmd-ot-imeni-administratora-v-windows-10/
4. В терминале переходим в папку с проектом (та папка где лежит файл package.json) и с помощью команды `npm i` устанавливаем зависимости проекта.
5. Осуществляем запуск сервера с помощью команды `npm start`
6. Пробуем перейти в браузере по ссылке http://localhost:3000/example
7. Если всё запустилось, то подготовительные работы завершены. Оставляем консоль запущенной (там будут выводиться все console.log), сервер автоматически перезапускается при изменении кода.

## Критерии оценивания

### На 25

Необходимо взять лабораторную 2 и поместить её в шаблон `todo.ejs`, затем необходимо описать get запрос по адресу "/", чтобы в качестве ответа был отрисован данный шаблон (см пример `views/example`). Результатом должна быть полностью рабочая лабораторная #2 отдающаяся по адресу localhost:3000.

### На 35

Запрограммировать запрос `/api/list` который будет отдавать список дел в формате json. Json файл с задачами `todolist.json`

### На 45

Сделать так, чтобы ваш клиентский JS код при открытии страницы делал запрос `/api/list`, а получив ответ в виде json файла выводил список задач на основе него.

Лучше создать функцию уннверсальную, которая будет полностью перерисовывать список: очищать его и восстанавливать, на основе переданного ему состояния.

### На 54

На сервере создать 2 запроса:

`POST /api/list` - Данный запрос должен добавлять новые элементы в файл `todolist.json`. Запрос должен в теле запроса принимать объект формата.
```json 
    {"task": "Описание задачи"}
```
Серверный код должен выполнить следующее:
- Прочитать содержимое файла `todolist.json`
- Найти в его содержимом объект с максимальным значением поля `id`. (это послужит отправной точкой для добавления нового элемента).
- Добавить в содержимое файла объект на основе полученных данных
```json
    {
        "id": "максимальное ID + 1",
        "task": "Описание задачи",
        "complete": "false"
    }
```
- Вернуть в качестве ответа json с текущим состоянием списка из файла
```json
[
    {
        "id": 1, 
        "task": "Поставить 25", 
        "complete": true
    },
    {
        "id": 2,
        "task": "Поставить 35",
        "complete": true
    },
    {
        "id": "максимальное ID + 1",
        "task": "Описание задачи",
        "complete": "false"
    }
]
```

Далее необходимо перерисовать страницу, с учётом новой добавленной задачи. Это делается как в задании на 45.

PUT /api/list - запрос отмечающий что задание выполнено.  запрос должен в теле запроса принимать объект формата.
```json 
    {
        "id": номер_задачи,
        "complete": true/false 
    }
```
- Прочитать содержимое файла `todolist.json`
- Найти в его содержимом объект с переданным в запросе значением поля `id`.
- изменить в данном объекте состояние выполнения и записать его обратно в файл.
- Вернуть в качестве ответа json с текущим состоянием списка из файла
```json
[
    {
        "id": 1, 
        "task": "Поставить 25", 
        "complete": true
    },
    {
        "id": 2,
        "task": "Поставить 35",
        "complete": true
    },
    {
        "id": "Поставить 45",
        "task": "Описание задачи",
        "complete": true
    }
]
```

Далее необходимо перерисовать страницу, с учётом новой добавленной задачи. Это делается как в задании на 45.